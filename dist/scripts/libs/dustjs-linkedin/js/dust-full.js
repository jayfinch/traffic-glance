!function(root){function Context(n,l,t,e){this.stack=n,this.global=l,this.blocks=t,this.templateName=e}function Stack(n,l,t,e){this.tail=l,this.isObject=n&&"object"==typeof n,this.head=n,this.index=t,this.of=e}function Stub(n){this.head=new Chunk(this),this.callback=n,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(n,l,t){this.root=n,this.next=l,this.data=[],this.flushable=!1,this.taps=t}function Tap(n,l){this.head=n,this.tail=l}var dust={},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",loggingLevels=[DEBUG,INFO,WARN,ERROR,NONE],EMPTY_FUNC=function(){},logger={},originalLog,loggerContext;dust.debugLevel=NONE,dust.silenceErrors=!1,root&&root.console&&root.console.log&&(loggerContext=root.console,originalLog=root.console.log),logger.log=loggerContext?function(){logger.log="function"==typeof originalLog?function(){originalLog.apply(loggerContext,arguments)}:function(){var n=Array.prototype.slice.apply(arguments).join(" ");originalLog(n)},logger.log.apply(this,arguments)}:function(){},dust.log=function(n,l){if(dust.isDebug&&dust.debugLevel===NONE&&(logger.log('[!!!DEPRECATION WARNING!!!]: dust.isDebug is deprecated.  Set dust.debugLevel instead to the level of logging you want ["debug","info","warn","error","none"]'),dust.debugLevel=INFO),l=l||INFO,dust.indexInArray(loggingLevels,l)>=dust.indexInArray(loggingLevels,dust.debugLevel)&&(dust.logQueue||(dust.logQueue=[]),dust.logQueue.push({message:n,type:l}),logger.log("[DUST "+l+"]: "+n)),!dust.silenceErrors&&l===ERROR)throw"string"==typeof n?new Error(n):n},dust.onError=function(n,l){if(logger.log("[!!!DEPRECATION WARNING!!!]: dust.onError will no longer return a chunk object."),dust.log(n.message||n,ERROR),dust.silenceErrors)return l;throw n},dust.helpers={},dust.cache={},dust.register=function(n,l){n&&(dust.cache[n]=l)},dust.render=function(n,l,t){var e=new Stub(t).head;try{dust.load(n,e,Context.wrap(l,n)).end()}catch(u){dust.log(u,ERROR)}},dust.stream=function(n,l){var t=new Stream;return dust.nextTick(function(){try{dust.load(n,t.head,Context.wrap(l,n)).end()}catch(e){dust.log(e,ERROR)}}),t},dust.renderSource=function(n,l,t){return dust.compileFn(n)(l,t)},dust.compileFn=function(n,l){l=l||null;var t=dust.loadSource(dust.compile(n,l));return function(n,e){var u=e?new Stub(e):new Stream;return dust.nextTick(function(){"function"==typeof t?t(u.head,Context.wrap(n,l)).end():dust.log(new Error("Template ["+l+"] cannot be resolved to a Dust function"),ERROR)}),u}},dust.load=function(n,l,t){var e=dust.cache[n];return e?e(l,t):dust.onLoad?l.map(function(l){dust.onLoad(n,function(e,u){return e?l.setError(e):(dust.cache[n]||dust.loadSource(dust.compile(u,n)),void dust.cache[n](l,t).end())})}):l.setError(new Error("Template Not Found: "+n))},dust.loadSource=function(source,path){return eval(source)},dust.isArray=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},dust.indexInArray=function(n,l,t){if(t=+t||0,Array.prototype.indexOf)return n.indexOf(l,t);if(void 0===n||null===n)throw new TypeError('cannot call method "indexOf" of null');var e=n.length;for(1/0===Math.abs(t)&&(t=0),0>t&&(t+=e,0>t&&(t=0));e>t;t++)if(n[t]===l)return t;return-1},dust.nextTick=function(){return function(n){setTimeout(n,0)}}(),dust.isEmpty=function(n){return dust.isArray(n)&&!n.length?!0:0===n?!1:!n},dust.filter=function(n,l,t){if(t)for(var e=0,u=t.length;u>e;e++){var r=t[e];"s"===r?(l=null,dust.log("Using unescape filter on ["+n+"]",DEBUG)):"function"==typeof dust.filters[r]?n=dust.filters[r](n):dust.log("Invalid filter ["+r+"]",WARN)}return l&&(n=dust.filters[l](n)),n},dust.filters={h:function(n){return dust.escapeHtml(n)},j:function(n){return dust.escapeJs(n)},u:encodeURI,uc:encodeURIComponent,js:function(n){return JSON?JSON.stringify(n):(dust.log("JSON is undefined.  JSON stringify has not been used on ["+n+"]",WARN),n)},jp:function(n){return JSON?JSON.parse(n):(dust.log("JSON is undefined.  JSON parse has not been used on ["+n+"]",WARN),n)}},dust.makeBase=function(n){return new Context(new Stack,n)},Context.wrap=function(n,l){return n instanceof Context?n:new Context(new Stack(n),{},null,l)},Context.prototype.get=function(n,l){return"string"==typeof n&&("."===n[0]&&(l=!0,n=n.substr(1)),n=n.split(".")),this._get(l,n)},Context.prototype._get=function(n,l){var t,e,u,r,o=this.stack,i=1;if(dust.log("Searching for reference [{"+l.join(".")+"}] in template ["+this.getTemplateName()+"]",DEBUG),e=l[0],u=l.length,n&&0===u)r=o,o=o.head;else{if(n)o&&(o=o.head?o.head[e]:void 0);else{for(;o&&(!o.isObject||(r=o.head,t=o.head[e],void 0===t));)o=o.tail;o=void 0!==t?t:this.global?this.global[e]:void 0}for(;o&&u>i;)r=o,o=o[l[i]],i++}if("function"==typeof o){var s=function(){try{return o.apply(r,arguments)}catch(n){return dust.log(n,ERROR)}};return s.isFunction=!0,s}return void 0===o&&dust.log("Cannot find the value for reference [{"+l.join(".")+"}] in template ["+this.getTemplateName()+"]"),o},Context.prototype.getPath=function(n,l){return this._get(n,l)},Context.prototype.push=function(n,l,t){return new Context(new Stack(n,this.stack,l,t),this.global,this.blocks,this.getTemplateName())},Context.prototype.rebase=function(n){return new Context(new Stack(n),this.global,this.blocks,this.getTemplateName())},Context.prototype.current=function(){return this.stack.head},Context.prototype.getBlock=function(n){if("function"==typeof n){var l=new Chunk;n=n(l,this).data.join("")}var t=this.blocks;if(!t)return void dust.log("No blocks for context[{"+n+"}] in template ["+this.getTemplateName()+"]",DEBUG);for(var e,u=t.length;u--;)if(e=t[u][n])return e},Context.prototype.shiftBlocks=function(n){var l,t=this.blocks;return n?(l=t?t.concat([n]):[n],new Context(this.stack,this.global,l,this.getTemplateName())):this},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var n=this.head;n;){if(!n.flushable)return n.error?(this.callback(n.error),dust.log("Chunk error ["+n.error+"] thrown. Ceasing to render this template.",WARN),void(this.flush=EMPTY_FUNC)):void 0;this.out+=n.data.join(""),n=n.next,this.head=n}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var n=this.head;n;){if(!n.flushable)return n.error?(this.emit("error",n.error),dust.log("Chunk error ["+n.error+"] thrown. Ceasing to render this template.",WARN),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",n.data.join("")),n=n.next,this.head=n}this.emit("end")},Stream.prototype.emit=function(n,l){if(!this.events)return dust.log("No events to emit",INFO),!1;var t=this.events[n];if(!t)return dust.log("Event type ["+n+"] does not exist",WARN),!1;if("function"==typeof t)t(l);else if(dust.isArray(t))for(var e=t.slice(0),u=0,r=e.length;r>u;u++)e[u](l);else dust.log("Event Handler ["+t+"] is not of a type that is handled by emit",WARN)},Stream.prototype.on=function(n,l){return this.events||(this.events={}),this.events[n]?"function"==typeof this.events[n]?this.events[n]=[this.events[n],l]:this.events[n].push(l):(dust.log("Event type ["+n+"] does not exist. Using just the specified callback.",WARN),l?this.events[n]=l:dust.log("Callback for type ["+n+"] does not exist. Listener not registered.",WARN)),this},Stream.prototype.pipe=function(n){return this.on("data",function(l){try{n.write(l,"utf8")}catch(t){dust.log(t,ERROR)}}).on("end",function(){try{return n.end()}catch(l){dust.log(l,ERROR)}}).on("error",function(l){n.error(l)}),this},Chunk.prototype.write=function(n){var l=this.taps;return l&&(n=l.go(n)),this.data.push(n),this},Chunk.prototype.end=function(n){return n&&this.write(n),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(n){var l=new Chunk(this.root,this.next,this.taps),t=new Chunk(this.root,l,this.taps);return this.next=t,this.flushable=!0,n(t),l},Chunk.prototype.tap=function(n){var l=this.taps;return this.taps=l?l.push(n):new Tap(n),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(n,l){return n(this,l)},Chunk.prototype.reference=function(n,l,t,e){return"function"==typeof n&&(n.isFunction=!0,n=n.apply(l.current(),[this,l,null,{auto:t,filters:e}]),n instanceof Chunk)?n:dust.isEmpty(n)?this:this.write(dust.filter(n,t,e))},Chunk.prototype.section=function(n,l,t,e){if("function"==typeof n&&(n=n.apply(l.current(),[this,l,t,e]),n instanceof Chunk))return n;var u=t.block,r=t["else"];if(e&&(l=l.push(e)),dust.isArray(n)){if(u){var o=n.length,i=this;if(o>0){l.stack.head&&(l.stack.head.$len=o);for(var s=0;o>s;s++)l.stack.head&&(l.stack.head.$idx=s),i=u(i,l.push(n[s],s,o));return l.stack.head&&(l.stack.head.$idx=void 0,l.stack.head.$len=void 0),i}if(r)return r(this,l)}}else if(n===!0){if(u)return u(this,l)}else if(n||0===n){if(u)return u(this,l.push(n))}else if(r)return r(this,l);return dust.log("Not rendering section (#) block in template ["+l.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.exists=function(n,l,t){var e=t.block,u=t["else"];if(dust.isEmpty(n)){if(u)return u(this,l)}else if(e)return e(this,l);return dust.log("Not rendering exists (?) block in template ["+l.getTemplateName()+"], because above key was not found",DEBUG),this},Chunk.prototype.notexists=function(n,l,t){var e=t.block,u=t["else"];if(dust.isEmpty(n)){if(e)return e(this,l)}else if(u)return u(this,l);return dust.log("Not rendering not exists (^) block check in template ["+l.getTemplateName()+"], because above key was found",DEBUG),this},Chunk.prototype.block=function(n,l,t){var e=t.block;return n&&(e=n),e?e(this,l):this},Chunk.prototype.partial=function(n,l,t){var e;e=dust.makeBase(l.global),e.blocks=l.blocks,l.stack&&l.stack.tail&&(e.stack=l.stack.tail),t&&(e=e.push(t)),"string"==typeof n&&(e.templateName=n),e=e.push(l.stack.head);var u;return u="function"==typeof n?this.capture(n,e,function(n,l){e.templateName=e.templateName||n,dust.load(n,l,e).end()}):dust.load(n,this,e)},Chunk.prototype.helper=function(n,l,t,e){var u=this;try{return dust.helpers[n]?dust.helpers[n](u,l,t,e):(dust.log("Invalid helper ["+n+"]",WARN),u)}catch(r){return dust.log(r,ERROR),u}},Chunk.prototype.capture=function(n,l,t){return this.map(function(e){var u=new Stub(function(n,l){n?e.setError(n):t(l,e)});n(u.head,l).end()})},Chunk.prototype.setError=function(n){return this.error=n,this.root.flush(),this},Tap.prototype.push=function(n){return new Tap(n,this)},Tap.prototype.go=function(n){for(var l=this;l;)n=l.head(n),l=l.tail;return n};var HCHARS=new RegExp(/[&<>\"\']/),AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(n){return"string"==typeof n?HCHARS.test(n)?n.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):n:n};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(n){return"string"==typeof n?n.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):n},"object"==typeof exports?module.exports=dust:root.dust=dust}(this),function(n,l){"object"==typeof exports?module.exports=l(require("./dust")):l(n.dust)}(this,function(n){var l=function(){function n(n){return'"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,e){function u(n){var l={};for(var t in n)l[t]=n[t];return l}function r(n,l){for(var e=n.offset+l,u=n.offset;e>u;u++){var r=t.charAt(u);"\n"===r?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1)}n.offset+=l}function o(n){Q.offset<$.offset||(Q.offset>$.offset&&($=u(Q),H=[]),H.push(n))}function i(){var n,l,t;for(t=u(Q),n=[],l=s();null!==l;)n.push(l),l=s();return null!==n&&(n=function(n,l,t,e){return["body"].concat(e).concat([["line",l],["col",t]])}(t.offset,t.line,t.column,n)),null===n&&(Q=u(t)),n}function s(){var n;return n=F(),null===n&&(n=L(),null===n&&(n=f(),null===n&&(n=m(),null===n&&(n=y(),null===n&&(n=g(),null===n&&(n=O())))))),n}function f(){var n,l,e,s,f,h,p,g,m;if(z++,g=u(Q),m=u(Q),n=c(),null!==n){for(l=[],e=G();null!==e;)l.push(e),e=G();null!==l?(e=U(),null!==e?(s=i(),null!==s?(f=d(),null!==f?(h=a(),h=null!==h?h:"",null!==h?(p=function(n,l,t,e,u,r,o){if(!o||e[1].text!==o.text)throw new Error("Expected end tag for "+e[1].text+" but it was not found. At line : "+l+", column : "+t);return!0}(Q.offset,Q.line,Q.column,n,s,f,h)?"":null,null!==p?n=[n,l,e,s,f,h,p]:(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))}else n=null,Q=u(m);if(null!==n&&(n=function(n,l,t,e,u,r){return r.push(["param",["literal","block"],u]),e.push(r),e.concat([["line",l],["col",t]])}(g.offset,g.line,g.column,n[0],n[3],n[4],n[5])),null===n&&(Q=u(g)),null===n){if(g=u(Q),m=u(Q),n=c(),null!==n){for(l=[],e=G();null!==e;)l.push(e),e=G();null!==l?(47===t.charCodeAt(Q.offset)?(e="/",r(Q,1)):(e=null,0===z&&o('"/"')),null!==e?(s=U(),null!==s?n=[n,l,e,s]:(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))}else n=null,Q=u(m);null!==n&&(n=function(n,l,t,e){return e.push(["bodies"]),e.concat([["line",l],["col",t]])}(g.offset,g.line,g.column,n[0])),null===n&&(Q=u(g))}return z--,0===z&&null===n&&o("section"),n}function c(){var n,l,e,i,s,f,c,a;if(c=u(Q),a=u(Q),n=_(),null!==n)if(/^[#?^<+@%]/.test(t.charAt(Q.offset))?(l=t.charAt(Q.offset),r(Q,1)):(l=null,0===z&&o("[#?^<+@%]")),null!==l){for(e=[],i=G();null!==i;)e.push(i),i=G();null!==e?(i=b(),null!==i?(s=h(),null!==s?(f=p(),null!==f?n=[n,l,e,i,s,f]:(n=null,Q=u(a))):(n=null,Q=u(a))):(n=null,Q=u(a))):(n=null,Q=u(a))}else n=null,Q=u(a);else n=null,Q=u(a);return null!==n&&(n=function(n,l,t,e,u,r,o){return[e,u,r,o]}(c.offset,c.line,c.column,n[1],n[3],n[4],n[5])),null===n&&(Q=u(c)),n}function a(){var n,l,e,i,s,f,c,a;if(z++,c=u(Q),a=u(Q),n=_(),null!==n)if(47===t.charCodeAt(Q.offset)?(l="/",r(Q,1)):(l=null,0===z&&o('"/"')),null!==l){for(e=[],i=G();null!==i;)e.push(i),i=G();if(null!==e)if(i=b(),null!==i){for(s=[],f=G();null!==f;)s.push(f),f=G();null!==s?(f=U(),null!==f?n=[n,l,e,i,s,f]:(n=null,Q=u(a))):(n=null,Q=u(a))}else n=null,Q=u(a);else n=null,Q=u(a)}else n=null,Q=u(a);else n=null,Q=u(a);return null!==n&&(n=function(n,l,t,e){return e}(c.offset,c.line,c.column,n[3])),null===n&&(Q=u(c)),z--,0===z&&null===n&&o("end tag"),n}function h(){var n,l,e,i,s;return e=u(Q),i=u(Q),s=u(Q),58===t.charCodeAt(Q.offset)?(n=":",r(Q,1)):(n=null,0===z&&o('":"')),null!==n?(l=b(),null!==l?n=[n,l]:(n=null,Q=u(s))):(n=null,Q=u(s)),null!==n&&(n=function(n,l,t,e){return e}(i.offset,i.line,i.column,n[1])),null===n&&(Q=u(i)),n=null!==n?n:"",null!==n&&(n=function(n,l,t,e){return e?["context",e]:["context"]}(e.offset,e.line,e.column,n)),null===n&&(Q=u(e)),n}function p(){var n,l,e,i,s,f,c,a;if(z++,f=u(Q),n=[],c=u(Q),a=u(Q),e=G(),null!==e)for(l=[];null!==e;)l.push(e),e=G();else l=null;for(null!==l?(e=C(),null!==e?(61===t.charCodeAt(Q.offset)?(i="=",r(Q,1)):(i=null,0===z&&o('"="')),null!==i?(s=A(),null===s&&(s=b(),null===s&&(s=w())),null!==s?l=[l,e,i,s]:(l=null,Q=u(a))):(l=null,Q=u(a))):(l=null,Q=u(a))):(l=null,Q=u(a)),null!==l&&(l=function(n,l,t,e,u){return["param",["literal",e],u]}(c.offset,c.line,c.column,l[1],l[3])),null===l&&(Q=u(c));null!==l;){if(n.push(l),c=u(Q),a=u(Q),e=G(),null!==e)for(l=[];null!==e;)l.push(e),e=G();else l=null;null!==l?(e=C(),null!==e?(61===t.charCodeAt(Q.offset)?(i="=",r(Q,1)):(i=null,0===z&&o('"="')),null!==i?(s=A(),null===s&&(s=b(),null===s&&(s=w())),null!==s?l=[l,e,i,s]:(l=null,Q=u(a))):(l=null,Q=u(a))):(l=null,Q=u(a))):(l=null,Q=u(a)),null!==l&&(l=function(n,l,t,e,u){return["param",["literal",e],u]}(c.offset,c.line,c.column,l[1],l[3])),null===l&&(Q=u(c))}return null!==n&&(n=function(n,l,t,e){return["params"].concat(e)}(f.offset,f.line,f.column,n)),null===n&&(Q=u(f)),z--,0===z&&null===n&&o("params"),n}function d(){var n,l,e,s,f,c,a,h,p;for(z++,a=u(Q),n=[],h=u(Q),p=u(Q),l=_(),null!==l?(58===t.charCodeAt(Q.offset)?(e=":",r(Q,1)):(e=null,0===z&&o('":"')),null!==e?(s=C(),null!==s?(f=U(),null!==f?(c=i(),null!==c?l=[l,e,s,f,c]:(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p)),null!==l&&(l=function(n,l,t,e,u){return["param",["literal",e],u]}(h.offset,h.line,h.column,l[2],l[4])),null===l&&(Q=u(h));null!==l;)n.push(l),h=u(Q),p=u(Q),l=_(),null!==l?(58===t.charCodeAt(Q.offset)?(e=":",r(Q,1)):(e=null,0===z&&o('":"')),null!==e?(s=C(),null!==s?(f=U(),null!==f?(c=i(),null!==c?l=[l,e,s,f,c]:(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p))):(l=null,Q=u(p)),null!==l&&(l=function(n,l,t,e,u){return["param",["literal",e],u]}(h.offset,h.line,h.column,l[2],l[4])),null===l&&(Q=u(h));return null!==n&&(n=function(n,l,t,e){return["bodies"].concat(e)}(a.offset,a.line,a.column,n)),null===n&&(Q=u(a)),z--,0===z&&null===n&&o("bodies"),n}function g(){var n,l,t,e,r,i;return z++,r=u(Q),i=u(Q),n=_(),null!==n?(l=b(),null!==l?(t=v(),null!==t?(e=U(),null!==e?n=[n,l,t,e]:(n=null,Q=u(i))):(n=null,Q=u(i))):(n=null,Q=u(i))):(n=null,Q=u(i)),null!==n&&(n=function(n,l,t,e,u){return["reference",e,u].concat([["line",l],["col",t]])}(r.offset,r.line,r.column,n[1],n[2])),null===n&&(Q=u(r)),z--,0===z&&null===n&&o("reference"),n}function m(){var n,l,e,i,s,f,c,a,d,g,m,v;if(z++,g=u(Q),m=u(Q),n=_(),null!==n)if(62===t.charCodeAt(Q.offset)?(l=">",r(Q,1)):(l=null,0===z&&o('">"')),null===l&&(43===t.charCodeAt(Q.offset)?(l="+",r(Q,1)):(l=null,0===z&&o('"+"'))),null!==l){for(e=[],i=G();null!==i;)e.push(i),i=G();if(null!==e)if(v=u(Q),i=C(),null!==i&&(i=function(n,l,t,e){return["literal",e]}(v.offset,v.line,v.column,i)),null===i&&(Q=u(v)),null===i&&(i=w()),null!==i)if(s=h(),null!==s)if(f=p(),null!==f){for(c=[],a=G();null!==a;)c.push(a),a=G();null!==c?(47===t.charCodeAt(Q.offset)?(a="/",r(Q,1)):(a=null,0===z&&o('"/"')),null!==a?(d=U(),null!==d?n=[n,l,e,i,s,f,c,a,d]:(n=null,Q=u(m))):(n=null,Q=u(m))):(n=null,Q=u(m))}else n=null,Q=u(m);else n=null,Q=u(m);else n=null,Q=u(m);else n=null,Q=u(m)}else n=null,Q=u(m);else n=null,Q=u(m);return null!==n&&(n=function(n,l,t,e,u,r,o){var i=">"===e?"partial":e;return[i,u,r,o].concat([["line",l],["col",t]])}(g.offset,g.line,g.column,n[1],n[3],n[4],n[5])),null===n&&(Q=u(g)),z--,0===z&&null===n&&o("partial"),n}function v(){var n,l,e,i,s,f;for(z++,i=u(Q),n=[],s=u(Q),f=u(Q),124===t.charCodeAt(Q.offset)?(l="|",r(Q,1)):(l=null,0===z&&o('"|"')),null!==l?(e=C(),null!==e?l=[l,e]:(l=null,Q=u(f))):(l=null,Q=u(f)),null!==l&&(l=function(n,l,t,e){return e}(s.offset,s.line,s.column,l[1])),null===l&&(Q=u(s));null!==l;)n.push(l),s=u(Q),f=u(Q),124===t.charCodeAt(Q.offset)?(l="|",r(Q,1)):(l=null,0===z&&o('"|"')),null!==l?(e=C(),null!==e?l=[l,e]:(l=null,Q=u(f))):(l=null,Q=u(f)),null!==l&&(l=function(n,l,t,e){return e}(s.offset,s.line,s.column,l[1])),null===l&&(Q=u(s));return null!==n&&(n=function(n,l,t,e){return["filters"].concat(e)}(i.offset,i.line,i.column,n)),null===n&&(Q=u(i)),z--,0===z&&null===n&&o("filters"),n}function y(){var n,l,e,i,s,f;return z++,s=u(Q),f=u(Q),n=_(),null!==n?(126===t.charCodeAt(Q.offset)?(l="~",r(Q,1)):(l=null,0===z&&o('"~"')),null!==l?(e=C(),null!==e?(i=U(),null!==i?n=[n,l,e,i]:(n=null,Q=u(f))):(n=null,Q=u(f))):(n=null,Q=u(f))):(n=null,Q=u(f)),null!==n&&(n=function(n,l,t,e){return["special",e].concat([["line",l],["col",t]])}(s.offset,s.line,s.column,n[2])),null===n&&(Q=u(s)),z--,0===z&&null===n&&o("special"),n}function b(){var n,l;return z++,l=u(Q),n=x(),null!==n&&(n=function(n,l,t,e){var u=["path"].concat(e);return u.text=e[1].join("."),u}(l.offset,l.line,l.column,n)),null===n&&(Q=u(l)),null===n&&(l=u(Q),n=C(),null!==n&&(n=function(n,l,t,e){var u=["key",e];return u.text=e,u}(l.offset,l.line,l.column,n)),null===n&&(Q=u(l))),z--,0===z&&null===n&&o("identifier"),n}function A(){var n,l;return z++,l=u(Q),n=N(),null===n&&(n=k()),null!==n&&(n=function(n,l,t,e){return["literal",e]}(l.offset,l.line,l.column,n)),null===n&&(Q=u(l)),z--,0===z&&null===n&&o("number"),n}function N(){var n,l,e,i,s,f;if(z++,s=u(Q),f=u(Q),n=k(),null!==n)if(46===t.charCodeAt(Q.offset)?(l=".",r(Q,1)):(l=null,0===z&&o('"."')),null!==l){if(i=k(),null!==i)for(e=[];null!==i;)e.push(i),i=k();else e=null;null!==e?n=[n,l,e]:(n=null,Q=u(f))}else n=null,Q=u(f);else n=null,Q=u(f);return null!==n&&(n=function(n,l,t,e,u){return parseFloat(e+"."+u.join(""))}(s.offset,s.line,s.column,n[0],n[2])),null===n&&(Q=u(s)),z--,0===z&&null===n&&o("float"),n}function k(){var n,l,e;if(z++,e=u(Q),/^[0-9]/.test(t.charAt(Q.offset))?(l=t.charAt(Q.offset),r(Q,1)):(l=null,0===z&&o("[0-9]")),null!==l)for(n=[];null!==l;)n.push(l),/^[0-9]/.test(t.charAt(Q.offset))?(l=t.charAt(Q.offset),r(Q,1)):(l=null,0===z&&o("[0-9]"));else n=null;return null!==n&&(n=function(n,l,t,e){return parseInt(e.join(""),10)}(e.offset,e.line,e.column,n)),null===n&&(Q=u(e)),z--,0===z&&null===n&&o("integer"),n}function x(){var n,l,e,i,s;if(z++,i=u(Q),s=u(Q),n=C(),n=null!==n?n:"",null!==n){if(e=R(),null===e&&(e=E()),null!==e)for(l=[];null!==e;)l.push(e),e=R(),null===e&&(e=E());else l=null;null!==l?n=[n,l]:(n=null,Q=u(s))}else n=null,Q=u(s);if(null!==n&&(n=function(n,l,t,e,u){return u=u[0],e&&u?(u.unshift(e),[!1,u].concat([["line",l],["col",t]])):[!0,u].concat([["line",l],["col",t]])}(i.offset,i.line,i.column,n[0],n[1])),null===n&&(Q=u(i)),null===n){if(i=u(Q),s=u(Q),46===t.charCodeAt(Q.offset)?(n=".",r(Q,1)):(n=null,0===z&&o('"."')),null!==n){for(l=[],e=R(),null===e&&(e=E());null!==e;)l.push(e),e=R(),null===e&&(e=E());null!==l?n=[n,l]:(n=null,Q=u(s))}else n=null,Q=u(s);null!==n&&(n=function(n,l,t,e){return e.length>0?[!0,e[0]].concat([["line",l],["col",t]]):[!0,[]].concat([["line",l],["col",t]])}(i.offset,i.line,i.column,n[1])),null===n&&(Q=u(i))}return z--,0===z&&null===n&&o("path"),n}function C(){var n,l,e,i,s;if(z++,i=u(Q),s=u(Q),/^[a-zA-Z_$]/.test(t.charAt(Q.offset))?(n=t.charAt(Q.offset),r(Q,1)):(n=null,0===z&&o("[a-zA-Z_$]")),null!==n){for(l=[],/^[0-9a-zA-Z_$\-]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o("[0-9a-zA-Z_$\\-]"));null!==e;)l.push(e),/^[0-9a-zA-Z_$\-]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o("[0-9a-zA-Z_$\\-]"));null!==l?n=[n,l]:(n=null,Q=u(s))}else n=null,Q=u(s);return null!==n&&(n=function(n,l,t,e,u){return e+u.join("")}(i.offset,i.line,i.column,n[0],n[1])),null===n&&(Q=u(i)),z--,0===z&&null===n&&o("key"),n}function E(){var n,l,e,i,s,f,c,a;if(z++,i=u(Q),s=u(Q),f=u(Q),c=u(Q),n=I(),null!==n){if(a=u(Q),/^[0-9]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o("[0-9]")),null!==e)for(l=[];null!==e;)l.push(e),/^[0-9]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o("[0-9]"));else l=null;null!==l&&(l=function(n,l,t,e){return e.join("")}(a.offset,a.line,a.column,l)),null===l&&(Q=u(a)),null===l&&(l=b()),null!==l?(e=D(),null!==e?n=[n,l,e]:(n=null,Q=u(c))):(n=null,Q=u(c))}else n=null,Q=u(c);return null!==n&&(n=function(n,l,t,e){return e}(f.offset,f.line,f.column,n[1])),null===n&&(Q=u(f)),null!==n?(l=R(),l=null!==l?l:"",null!==l?n=[n,l]:(n=null,Q=u(s))):(n=null,Q=u(s)),null!==n&&(n=function(n,l,t,e,u){return u?u.unshift(e):u=[e],u}(i.offset,i.line,i.column,n[0],n[1])),null===n&&(Q=u(i)),z--,0===z&&null===n&&o("array"),n}function R(){var n,l,e,i,s,f,c;if(z++,i=u(Q),s=u(Q),f=u(Q),c=u(Q),46===t.charCodeAt(Q.offset)?(l=".",r(Q,1)):(l=null,0===z&&o('"."')),null!==l?(e=C(),null!==e?l=[l,e]:(l=null,Q=u(c))):(l=null,Q=u(c)),null!==l&&(l=function(n,l,t,e){return e}(f.offset,f.line,f.column,l[1])),null===l&&(Q=u(f)),null!==l)for(n=[];null!==l;)n.push(l),f=u(Q),c=u(Q),46===t.charCodeAt(Q.offset)?(l=".",r(Q,1)):(l=null,0===z&&o('"."')),null!==l?(e=C(),null!==e?l=[l,e]:(l=null,Q=u(c))):(l=null,Q=u(c)),null!==l&&(l=function(n,l,t,e){return e}(f.offset,f.line,f.column,l[1])),null===l&&(Q=u(f));else n=null;return null!==n?(l=E(),l=null!==l?l:"",null!==l?n=[n,l]:(n=null,Q=u(s))):(n=null,Q=u(s)),null!==n&&(n=function(n,l,t,e,u){return u?e.concat(u):e}(i.offset,i.line,i.column,n[0],n[1])),null===n&&(Q=u(i)),z--,0===z&&null===n&&o("array_part"),n}function w(){var n,l,e,i,s;if(z++,i=u(Q),s=u(Q),34===t.charCodeAt(Q.offset)?(n='"',r(Q,1)):(n=null,0===z&&o('"\\""')),null!==n?(34===t.charCodeAt(Q.offset)?(l='"',r(Q,1)):(l=null,0===z&&o('"\\""')),null!==l?n=[n,l]:(n=null,Q=u(s))):(n=null,Q=u(s)),null!==n&&(n=function(n,l,t){return["literal",""].concat([["line",l],["col",t]])}(i.offset,i.line,i.column)),null===n&&(Q=u(i)),null===n&&(i=u(Q),s=u(Q),34===t.charCodeAt(Q.offset)?(n='"',r(Q,1)):(n=null,0===z&&o('"\\""')),null!==n?(l=T(),null!==l?(34===t.charCodeAt(Q.offset)?(e='"',r(Q,1)):(e=null,0===z&&o('"\\""')),null!==e?n=[n,l,e]:(n=null,Q=u(s))):(n=null,Q=u(s))):(n=null,Q=u(s)),null!==n&&(n=function(n,l,t,e){return["literal",e].concat([["line",l],["col",t]])}(i.offset,i.line,i.column,n[1])),null===n&&(Q=u(i)),null===n)){if(i=u(Q),s=u(Q),34===t.charCodeAt(Q.offset)?(n='"',r(Q,1)):(n=null,0===z&&o('"\\""')),null!==n){if(e=S(),null!==e)for(l=[];null!==e;)l.push(e),e=S();else l=null;null!==l?(34===t.charCodeAt(Q.offset)?(e='"',r(Q,1)):(e=null,0===z&&o('"\\""')),null!==e?n=[n,l,e]:(n=null,Q=u(s))):(n=null,Q=u(s))}else n=null,Q=u(s);null!==n&&(n=function(n,l,t,e){return["body"].concat(e).concat([["line",l],["col",t]])}(i.offset,i.line,i.column,n[1])),null===n&&(Q=u(i))}return z--,0===z&&null===n&&o("inline"),n}function S(){var n,l;return n=y(),null===n&&(n=g(),null===n&&(l=u(Q),n=T(),null!==n&&(n=function(n,l,t,e){return["buffer",e]}(l.offset,l.line,l.column,n)),null===n&&(Q=u(l)))),n}function O(){var n,l,e,i,s,f,c,a,h,p;if(z++,c=u(Q),a=u(Q),n=W(),null!==n){for(l=[],e=G();null!==e;)l.push(e),e=G();null!==l?n=[n,l]:(n=null,Q=u(a))}else n=null,Q=u(a);if(null!==n&&(n=function(n,l,t,e,u){return["format",e,u.join("")].concat([["line",l],["col",t]])}(c.offset,c.line,c.column,n[0],n[1])),null===n&&(Q=u(c)),null===n){if(c=u(Q),a=u(Q),h=u(Q),p=u(Q),z++,l=B(),z--,null===l?l="":(l=null,Q=u(p)),null!==l?(p=u(Q),z++,e=F(),z--,null===e?e="":(e=null,Q=u(p)),null!==e?(p=u(Q),z++,i=L(),z--,null===i?i="":(i=null,Q=u(p)),null!==i?(p=u(Q),z++,s=W(),z--,null===s?s="":(s=null,Q=u(p)),null!==s?(t.length>Q.offset?(f=t.charAt(Q.offset),r(Q,1)):(f=null,0===z&&o("any character")),null!==f?l=[l,e,i,s,f]:(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h)),null!==l&&(l=function(n,l,t,e){return e}(a.offset,a.line,a.column,l[4])),null===l&&(Q=u(a)),null!==l)for(n=[];null!==l;)n.push(l),a=u(Q),h=u(Q),p=u(Q),z++,l=B(),z--,null===l?l="":(l=null,Q=u(p)),null!==l?(p=u(Q),z++,e=F(),z--,null===e?e="":(e=null,Q=u(p)),null!==e?(p=u(Q),z++,i=L(),z--,null===i?i="":(i=null,Q=u(p)),null!==i?(p=u(Q),z++,s=W(),z--,null===s?s="":(s=null,Q=u(p)),null!==s?(t.length>Q.offset?(f=t.charAt(Q.offset),r(Q,1)):(f=null,0===z&&o("any character")),null!==f?l=[l,e,i,s,f]:(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h))):(l=null,Q=u(h)),null!==l&&(l=function(n,l,t,e){return e}(a.offset,a.line,a.column,l[4])),null===l&&(Q=u(a));else n=null;null!==n&&(n=function(n,l,t,e){return["buffer",e.join("")].concat([["line",l],["col",t]])}(c.offset,c.line,c.column,n)),null===n&&(Q=u(c))}return z--,0===z&&null===n&&o("buffer"),n}function T(){var n,l,e,i,s,f,c;if(z++,i=u(Q),s=u(Q),f=u(Q),c=u(Q),z++,l=B(),z--,null===l?l="":(l=null,Q=u(c)),null!==l?(e=j(),null===e&&(/^[^"]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o('[^"]'))),null!==e?l=[l,e]:(l=null,Q=u(f))):(l=null,Q=u(f)),null!==l&&(l=function(n,l,t,e){return e}(s.offset,s.line,s.column,l[1])),null===l&&(Q=u(s)),null!==l)for(n=[];null!==l;)n.push(l),s=u(Q),f=u(Q),c=u(Q),z++,l=B(),z--,null===l?l="":(l=null,Q=u(c)),null!==l?(e=j(),null===e&&(/^[^"]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o('[^"]'))),null!==e?l=[l,e]:(l=null,Q=u(f))):(l=null,Q=u(f)),null!==l&&(l=function(n,l,t,e){return e}(s.offset,s.line,s.column,l[1])),null===l&&(Q=u(s));else n=null;return null!==n&&(n=function(n,l,t,e){return e.join("")}(i.offset,i.line,i.column,n)),null===n&&(Q=u(i)),z--,0===z&&null===n&&o("literal"),n}function j(){var n,l;return l=u(Q),'\\"'===t.substr(Q.offset,2)?(n='\\"',r(Q,2)):(n=null,0===z&&o('"\\\\\\""')),null!==n&&(n=function(){return'"'}(l.offset,l.line,l.column)),null===n&&(Q=u(l)),n}function F(){var n,l,e,i,s,f,c,a,h;if(z++,s=u(Q),f=u(Q),"{`"===t.substr(Q.offset,2)?(n="{`",r(Q,2)):(n=null,0===z&&o('"{`"')),null!==n){for(l=[],c=u(Q),a=u(Q),h=u(Q),z++,"`}"===t.substr(Q.offset,2)?(e="`}",r(Q,2)):(e=null,0===z&&o('"`}"')),z--,null===e?e="":(e=null,Q=u(h)),null!==e?(t.length>Q.offset?(i=t.charAt(Q.offset),r(Q,1)):(i=null,0===z&&o("any character")),null!==i?e=[e,i]:(e=null,Q=u(a))):(e=null,Q=u(a)),null!==e&&(e=function(n,l,t,e){return e}(c.offset,c.line,c.column,e[1])),null===e&&(Q=u(c));null!==e;)l.push(e),c=u(Q),a=u(Q),h=u(Q),z++,"`}"===t.substr(Q.offset,2)?(e="`}",r(Q,2)):(e=null,0===z&&o('"`}"')),z--,null===e?e="":(e=null,Q=u(h)),null!==e?(t.length>Q.offset?(i=t.charAt(Q.offset),r(Q,1)):(i=null,0===z&&o("any character")),null!==i?e=[e,i]:(e=null,Q=u(a))):(e=null,Q=u(a)),null!==e&&(e=function(n,l,t,e){return e}(c.offset,c.line,c.column,e[1])),null===e&&(Q=u(c));null!==l?("`}"===t.substr(Q.offset,2)?(e="`}",r(Q,2)):(e=null,0===z&&o('"`}"')),null!==e?n=[n,l,e]:(n=null,Q=u(f))):(n=null,Q=u(f))}else n=null,Q=u(f);return null!==n&&(n=function(n,l,t,e){return["raw",e.join("")].concat([["line",l],["col",t]])}(s.offset,s.line,s.column,n[1])),null===n&&(Q=u(s)),z--,0===z&&null===n&&o("raw"),n}function L(){var n,l,e,i,s,f,c,a,h;if(z++,s=u(Q),f=u(Q),"{!"===t.substr(Q.offset,2)?(n="{!",r(Q,2)):(n=null,0===z&&o('"{!"')),null!==n){for(l=[],c=u(Q),a=u(Q),h=u(Q),z++,"!}"===t.substr(Q.offset,2)?(e="!}",r(Q,2)):(e=null,0===z&&o('"!}"')),z--,null===e?e="":(e=null,Q=u(h)),null!==e?(t.length>Q.offset?(i=t.charAt(Q.offset),r(Q,1)):(i=null,0===z&&o("any character")),null!==i?e=[e,i]:(e=null,Q=u(a))):(e=null,Q=u(a)),null!==e&&(e=function(n,l,t,e){return e}(c.offset,c.line,c.column,e[1])),null===e&&(Q=u(c));null!==e;)l.push(e),c=u(Q),a=u(Q),h=u(Q),z++,"!}"===t.substr(Q.offset,2)?(e="!}",r(Q,2)):(e=null,0===z&&o('"!}"')),z--,null===e?e="":(e=null,Q=u(h)),null!==e?(t.length>Q.offset?(i=t.charAt(Q.offset),r(Q,1)):(i=null,0===z&&o("any character")),null!==i?e=[e,i]:(e=null,Q=u(a))):(e=null,Q=u(a)),null!==e&&(e=function(n,l,t,e){return e}(c.offset,c.line,c.column,e[1])),null===e&&(Q=u(c));null!==l?("!}"===t.substr(Q.offset,2)?(e="!}",r(Q,2)):(e=null,0===z&&o('"!}"')),null!==e?n=[n,l,e]:(n=null,Q=u(f))):(n=null,Q=u(f))}else n=null,Q=u(f);return null!==n&&(n=function(n,l,t,e){return["comment",e.join("")].concat([["line",l],["col",t]])}(s.offset,s.line,s.column,n[1])),null===n&&(Q=u(s)),z--,0===z&&null===n&&o("comment"),n}function B(){var n,l,e,i,s,f,c,a,h,p,d;if(h=u(Q),n=_(),null!==n){for(l=[],e=G();null!==e;)l.push(e),e=G();if(null!==l)if(/^[#?^><+%:@\/~%]/.test(t.charAt(Q.offset))?(e=t.charAt(Q.offset),r(Q,1)):(e=null,0===z&&o("[#?^><+%:@\\/~%]")),null!==e){for(i=[],s=G();null!==s;)i.push(s),s=G();if(null!==i){if(p=u(Q),d=u(Q),z++,f=U(),z--,null===f?f="":(f=null,Q=u(d)),null!==f?(d=u(Q),z++,c=W(),z--,null===c?c="":(c=null,Q=u(d)),null!==c?(t.length>Q.offset?(a=t.charAt(Q.offset),r(Q,1)):(a=null,0===z&&o("any character")),null!==a?f=[f,c,a]:(f=null,Q=u(p))):(f=null,Q=u(p))):(f=null,Q=u(p)),null!==f)for(s=[];null!==f;)s.push(f),p=u(Q),d=u(Q),z++,f=U(),z--,null===f?f="":(f=null,Q=u(d)),null!==f?(d=u(Q),z++,c=W(),z--,null===c?c="":(c=null,Q=u(d)),null!==c?(t.length>Q.offset?(a=t.charAt(Q.offset),r(Q,1)):(a=null,0===z&&o("any character")),null!==a?f=[f,c,a]:(f=null,Q=u(p))):(f=null,Q=u(p))):(f=null,Q=u(p));else s=null;if(null!==s){for(f=[],c=G();null!==c;)f.push(c),c=G();null!==f?(c=U(),null!==c?n=[n,l,e,i,s,f,c]:(n=null,Q=u(h))):(n=null,Q=u(h))}else n=null,Q=u(h)}else n=null,Q=u(h)}else n=null,Q=u(h);else n=null,Q=u(h)}else n=null,Q=u(h);return null===n&&(n=g()),n}function _(){var n;return 123===t.charCodeAt(Q.offset)?(n="{",r(Q,1)):(n=null,0===z&&o('"{"')),n
}function U(){var n;return 125===t.charCodeAt(Q.offset)?(n="}",r(Q,1)):(n=null,0===z&&o('"}"')),n}function I(){var n;return 91===t.charCodeAt(Q.offset)?(n="[",r(Q,1)):(n=null,0===z&&o('"["')),n}function D(){var n;return 93===t.charCodeAt(Q.offset)?(n="]",r(Q,1)):(n=null,0===z&&o('"]"')),n}function W(){var n;return 10===t.charCodeAt(Q.offset)?(n="\n",r(Q,1)):(n=null,0===z&&o('"\\n"')),null===n&&("\r\n"===t.substr(Q.offset,2)?(n="\r\n",r(Q,2)):(n=null,0===z&&o('"\\r\\n"')),null===n&&(13===t.charCodeAt(Q.offset)?(n="\r",r(Q,1)):(n=null,0===z&&o('"\\r"')),null===n&&(8232===t.charCodeAt(Q.offset)?(n="\u2028",r(Q,1)):(n=null,0===z&&o('"\\u2028"')),null===n&&(8233===t.charCodeAt(Q.offset)?(n="\u2029",r(Q,1)):(n=null,0===z&&o('"\\u2029"')))))),n}function G(){var n;return/^[\t\x0B\f \xA0\uFEFF]/.test(t.charAt(Q.offset))?(n=t.charAt(Q.offset),r(Q,1)):(n=null,0===z&&o("[\\t\\x0B\\f \\xA0\\uFEFF]")),null===n&&(n=W()),n}function J(n){n.sort();for(var l=null,t=[],e=0;e<n.length;e++)n[e]!==l&&(t.push(n[e]),l=n[e]);return t}var P={body:i,part:s,section:f,sec_tag_start:c,end_tag:a,context:h,params:p,bodies:d,reference:g,partial:m,filters:v,special:y,identifier:b,number:A,"float":N,integer:k,path:x,key:C,array:E,array_part:R,inline:w,inline_part:S,buffer:O,literal:T,esc:j,raw:F,comment:L,tag:B,ld:_,rd:U,lb:I,rb:D,eol:W,ws:G};if(void 0!==e){if(void 0===P[e])throw new Error("Invalid rule name: "+n(e)+".")}else e="body";var Q={offset:0,line:1,column:1,seenCR:!1},z=0,$={offset:0,line:1,column:1,seenCR:!1},H=[],M=P[e]();if(null===M||Q.offset!==t.length){var Z=Math.max(Q.offset,$.offset),q=Z<t.length?t.charAt(Z):null,Y=Q.offset>$.offset?Q:$;throw new l.SyntaxError(J(H),q,Z,Y.line,Y.column)}return M},toSource:function(){return this._source}};return t.SyntaxError=function(l,t,e,u,r){function o(l,t){var e,u;switch(l.length){case 0:e="end of input";break;case 1:e=l[0];break;default:e=l.slice(0,l.length-1).join(", ")+" or "+l[l.length-1]}return u=t?n(t):"end of input","Expected "+e+" but "+u+" found."}this.name="SyntaxError",this.expected=l,this.found=t,this.message=o(l,t),this.offset=e,this.line=u,this.column=r},t.SyntaxError.prototype=Error.prototype,t}();return n.parse=l.parse,l}),function(n,l){"object"==typeof exports?module.exports=l(require("./parser").parse,require("./dust")):l(n.dust.parse,n.dust)}(this,function(n,l){function t(n){var l={};return d.filterNode(l,n)}function e(n,l){var t,e,u,r=[l[0]];for(t=1,e=l.length;e>t;t++)u=d.filterNode(n,l[t]),u&&r.push(u);return r}function u(n,l){var t,e,u,r,o=[l[0]];for(e=1,u=l.length;u>e;e++)r=d.filterNode(n,l[e]),r&&("buffer"===r[0]?t?t[1]+=r[1]:(t=r,o.push(r)):(t=null,o.push(r)));return o}function r(n,l){return["buffer",m[l[1]]]}function o(n,l){return l}function i(){}function s(n,l){var t={name:l,bodies:[],blocks:{},index:0,auto:"h"};return"(function(){dust.register("+(l?'"'+l+'"':"null")+","+d.compileNode(t,n)+");"+f(t)+c(t)+"return body_0;})();"}function f(n){var l,t=[],e=n.blocks;for(l in e)t.push('"'+l+'":'+e[l]);return t.length?(n.blocks="ctx=ctx.shiftBlocks(blocks);","var blocks={"+t.join(",")+"};"):n.blocks=""}function c(n){var l,t,e=[],u=n.bodies,r=n.blocks;for(l=0,t=u.length;t>l;l++)e[l]="function body_"+l+"(chk,ctx){"+r+"return chk"+u[l]+";}";return e.join("")}function a(n,l){var t,e,u="";for(t=1,e=l.length;e>t;t++)u+=d.compileNode(n,l[t]);return u}function h(n,l,t){return"."+t+"("+d.compileNode(n,l[1])+","+d.compileNode(n,l[2])+","+d.compileNode(n,l[4])+","+d.compileNode(n,l[3])+")"}function p(n){return n.replace(v,"\\\\").replace(y,'\\"').replace(b,"\\f").replace(A,"\\n").replace(N,"\\r").replace(k,"\\t")}var d={},g=l.isArray;d.compile=function(e,u){u||null===u||l.log(new Error("Template name parameter cannot be undefined when calling dust.compile"),"ERROR");try{var r=t(n(e));return s(r,u)}catch(o){if(!o.line||!o.column)throw o;throw new SyntaxError(o.message+" At line : "+o.line+", column : "+o.column)}},d.filterNode=function(n,l){return d.optimizers[l[0]](n,l)},d.optimizers={body:u,buffer:o,special:r,format:i,reference:e,"#":e,"?":e,"^":e,"<":e,"+":e,"@":e,"%":e,partial:e,context:e,params:e,bodies:e,param:e,filters:o,key:o,path:o,literal:o,raw:o,comment:i,line:i,col:i},d.pragmas={esc:function(n,l,t){var e,u=n.auto;return l||(l="h"),n.auto="s"===l?"":l,e=a(n,t.block),n.auto=u,e}};var m={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};d.compileNode=function(n,l){return d.nodes[l[0]](n,l)},d.nodes={body:function(n,l){var t=n.index++,e="body_"+t;return n.bodies[t]=a(n,l),e},buffer:function(n,l){return".write("+x(l[1])+")"},format:function(n,l){return".write("+x(l[1]+l[2])+")"},reference:function(n,l){return".reference("+d.compileNode(n,l[1])+",ctx,"+d.compileNode(n,l[2])+")"},"#":function(n,l){return h(n,l,"section")},"?":function(n,l){return h(n,l,"exists")},"^":function(n,l){return h(n,l,"notexists")},"<":function(n,l){for(var t=l[4],e=1,u=t.length;u>e;e++){var r=t[e],o=r[1][1];if("block"===o)return n.blocks[l[1].text]=d.compileNode(n,r[2]),""}return""},"+":function(n,l){return"undefined"==typeof l[1].text&&"undefined"==typeof l[4]?".block(ctx.getBlock("+d.compileNode(n,l[1])+",chk, ctx),"+d.compileNode(n,l[2])+", {},"+d.compileNode(n,l[3])+")":".block(ctx.getBlock("+x(l[1].text)+"),"+d.compileNode(n,l[2])+","+d.compileNode(n,l[4])+","+d.compileNode(n,l[3])+")"},"@":function(n,l){return".helper("+x(l[1].text)+","+d.compileNode(n,l[2])+","+d.compileNode(n,l[4])+","+d.compileNode(n,l[3])+")"},"%":function(n,l){var t,e,u,r,o,i,s,f,c,a=l[1][1];if(!d.pragmas[a])return"";for(t=l[4],e={},f=1,c=t.length;c>f;f++)i=t[f],e[i[1][1]]=i[2];for(u=l[3],r={},f=1,c=u.length;c>f;f++)s=u[f],r[s[1][1]]=s[2][1];return o=l[2][1]?l[2][1].text:null,d.pragmas[a](n,o,e,r)},partial:function(n,l){return".partial("+d.compileNode(n,l[1])+","+d.compileNode(n,l[2])+","+d.compileNode(n,l[3])+")"},context:function(n,l){return l[1]?"ctx.rebase("+d.compileNode(n,l[1])+")":"ctx"},params:function(n,l){for(var t=[],e=1,u=l.length;u>e;e++)t.push(d.compileNode(n,l[e]));return t.length?"{"+t.join(",")+"}":"null"},bodies:function(n,l){for(var t=[],e=1,u=l.length;u>e;e++)t.push(d.compileNode(n,l[e]));return"{"+t.join(",")+"}"},param:function(n,l){return d.compileNode(n,l[1])+":"+d.compileNode(n,l[2])},filters:function(n,l){for(var t=[],e=1,u=l.length;u>e;e++){var r=l[e];t.push('"'+r+'"')}return'"'+n.auto+'"'+(t.length?",["+t.join(",")+"]":"")},key:function(n,l){return'ctx.get(["'+l[1]+'"], false)'},path:function(n,l){for(var t=l[1],e=l[2],u=[],r=0,o=e.length;o>r;r++)u.push(g(e[r])?d.compileNode(n,e[r]):'"'+e[r]+'"');return"ctx.getPath("+t+", ["+u.join(",")+"])"},literal:function(n,l){return x(l[1])},raw:function(n,l){return".write("+x(l[1])+")"}};var v=/\\/g,y=/"/g,b=/\f/g,A=/\n/g,N=/\r/g,k=/\t/g,x="undefined"==typeof JSON?function(n){return'"'+p(n)+'"'}:JSON.stringify;return l.compile=d.compile,l.filterNode=d.filterNode,l.optimizers=d.optimizers,l.pragmas=d.pragmas,l.compileNode=d.compileNode,l.nodes=d.nodes,d});
//# sourceMappingURL=dust-full.js.map